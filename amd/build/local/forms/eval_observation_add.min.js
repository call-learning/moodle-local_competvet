define("local_competvet/local/forms/eval_observation_add",["exports","core/ajax","core/modal_events","mod_competvet/local/forms/generic_form_helper","./modal_debug","core/str"],(function(_exports,_ajax,_modal_events,_generic_form_helper,_modal_debug,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript adding a new observation.
   *
   * @module     local_competvet/local/forms/observation_add_form
   * @copyright  2023 Laurent David <laurent@call-learning.fr>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_ajax=_interopRequireDefault(_ajax),_modal_events=_interopRequireDefault(_modal_events);_exports.init=async modulename=>{const selectedElements=(0,_generic_form_helper.getSelectedElement)("add");selectedElements&&selectedElements.forEach((element=>{element.addEventListener("click",(async event=>{event.preventDefault();const data=event.target.closest("[data-action]").dataset;let datasetLowercase=Object.entries(data).reduce(((acc,_ref)=>{let[key,value]=_ref;return acc[key.toLowerCase()]=value,acc}),{});const payLoad={category:1,planningid:datasetLowercase.planningid,studentid:datasetLowercase.studentid},observation=await _ajax.default.call([{methodname:"local_competvet_create_eval_observation",args:payLoad}])[0],modal=await(0,_modal_debug.createModalDebug)({content:await(0,_str.get_string)("observation:created","local_competvet"),debugs:[{apifunction:"local_competvet_ask_eval_observation",params:JSON.stringify(payLoad),results:[JSON.stringify(observation)]}]});modal.show(),modal.getRoot().on(_modal_events.default.cancel,(()=>{(0,_generic_form_helper.genericFormCreate)({id:observation.observationid},"edit",modulename,_modal_debug.createModalDebugFromEvent)}))}))}))}}));

//# sourceMappingURL=eval_observation_add.min.js.map